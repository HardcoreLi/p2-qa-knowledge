---
title: "Jenkins 打包机使用"
aliases:
  - "jenkins"
  - "打包机"
  - "打包"
  - "出包"
  - "构建包"
  - "打包机地址"
  - "dlc打包机"
  - "上传打包机"
tags:
  - "工具"
  - "打包"
  - "客户端"
updated: "2026-02-12"
source: "内部文档"
---

# Jenkins 打包机使用

## 简答
> Jenkins 是打包机系统，用于构建安卓/iOS 客户端包和 DLC。国际服和国服使用不同的打包机地址。

---

## 统一登录信息

| 项目 | 值 |
|------|-----|
| 账号 | p2admin |
| 密码 | p2admin123123 |

---

## P2 打包机地址汇总

### 整包打包机

| 用途 | 地址 |
|------|------|
| **国际服整包** | http://172.20.110.10:8080/ |
| **国服整包** | http://172.20.110.8:8080/ |

### DLC 打包机

| 用途 | 地址 | 备注 |
|------|------|------|
| **线上 DLC** | http://172.20.110.28:8080/ | 主用 |
| **线上 DLC** | http://172.20.160.34:8080/ | 不常用 |
| **测试 DLC** | http://172.20.110.14:8080/ | |
| **测试 DLC** | http://172.20.110.40:8080/ | |

### 其他打包机

| 用途 | 地址 |
|------|------|
| **自动化打包机** | http://172.20.160.21:8080/ |
| **上传打包机** | http://172.20.110.9:8080/ |

**上传打包机**可查看整包、DLC 上传状态。

---

## 使用规则

- **世界服包必须用 10 打包机**（172.20.110.10）
- **国服包必须用 8 打包机**（172.20.110.8）
- **混用会导致整包和 DLC 大小异常**

---

## 国际服打包

### 安卓测试包
1. 使用工程：`p2-android-temp`
2. 点击「Build with Parameters」
3. 配置参数：
   - **GitBranch**：填写客户端分支
   - **CHANNELS**：勾选需要出的渠道
   - **BuildAppBundle**：是否构建 aab 包
4. 点击「Build」开始打包

### 安卓正式包
1. 使用工程：`p2-android-master`
2. 额外选项：
   - **UploadSymbolFileToFirebase**：上传 Firebase 符号文件
   - **PublishToGooglePlay**：自动上传到谷歌商店

### iOS 包
1. 使用工程：`p2-ios-temp`
2. **BuildVariants**：选择渠道（AppStore/俄罗斯包等）
3. **AdHoc**：
   - 勾选 = 测试包（只能进测试环境）
   - 不勾选 = 正式包（可提审）

---

## 国服打包

### 安卓包
- 使用工程：`android-channel-build-cn`
- 分支：`hotfix_cn`
- 出的包可进正式环境，进测试环境需要 OTA

### iOS 包
- 使用工程：`p2-ios-temp-cn`
- 分支：`hotfix`（75 分支已统一）
- 勾选国服渠道

---

## Workspace 下载地址

当构建完成后需要手动下载包时，可通过 workspace 路径获取。

### 安卓包下载路径

```
http://172.20.110.10:8080/job/{工程名}/ws/client/Build/{包名}.{版本号}.{构建号}/launcher/build/publish/{渠道}Release/
```

**示例**：
```
http://172.20.110.10:8080/job/p2-android-master/ws/client/Build/com.tap4fun.ape.gplay.0.83.1.47225/launcher/build/publish/chromeosRelease/
```

### iOS 包下载路径

```
http://172.20.110.9:8080/job/XcodeBuildIPA/ws/Build/{包名}.{版本号}.{构建号}/Export/
```

**示例**：
```
http://172.20.110.9:8080/job/XcodeBuildIPA/ws/Build/com.tap4fun.ape.appstore.0.56.0.4411/Export/
```

---

## 两种打包结果场景

| 场景 | 说明 | 处理方式 |
|------|------|----------|
| **只有构建信息，无装包二维码** | 构建完成但未生成二维码 | 去 workspace 下载 |
| **无构建信息，只有装包二维码** | 打包信息里找小版本号确认打包分支 | 扫码安装或去 workspace 下载 |

### 手动上传场景

> ⚠️ 现在要上传商店的正式包如果**自动上传失败**，手动上传前都要去 Jenkins 的 **workspace** 下载

---

## 常见坑点

- **国服国际服打包机不可混用**：注意区分地址
- **10 打包机用于正式包**：尽量不要打其他分支的 DLC
- **aab 包只有部分渠道支持**：GP、马甲包、PC 包可构建 aab+apk
- **上传失败**：先用 Jenkins 上传，仍失败则在打包机上下载包手动上传
- **找不到构建信息**：通过打包信息里的小版本号确认打包分支

---

## 相关链接

| 用途 | 地址 |
|------|------|
| 国际服整包 | http://172.20.110.10:8080/ |
| 国服整包 | http://172.20.110.8:8080/ |
| 线上 DLC | http://172.20.110.28:8080/ |
| 测试 DLC | http://172.20.110.14:8080/ |
| 上传状态查看 | http://172.20.110.9:8080/ |
