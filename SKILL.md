# P2 QA 知识库

> 智能问答式知识库，支持自然语言查询，快速获取测试相关知识。

## 触发场景

当用户提问以下类型问题时自动激活：
- 工具使用问题："如何使用Kadmin？"、"Jenkins怎么打包？"、"TGS怎么配置？"
- 环境配置问题："aab包怎么安装？"、"环境怎么回退？"、"客户端进不去怎么办？"
- 测试流程问题："新服测试怎么做？"、"合服测试流程是什么？"、"DLC怎么验证？"
- 参考资料查询："有哪些渠道包？"、"各渠道登录方式是什么？"
- 关键词触发：kadmin、jenkins、tgs、entrance、aab、dlc、合服、新服、渠道、打包、热更、回退

## 工作流程

1. **读取索引**：首先读取 `_index.json` 获取所有知识条目的摘要和别名
2. **匹配查询**：根据用户问题匹配最相关的条目（通过 title、aliases、tags、summary）
3. **模糊问题追问**：如果问题涉及多个场景，先向用户确认具体需求（见下方规则）
4. **读取详情**：读取匹配条目的完整内容
5. **关联提醒**：检查是否有相关的注意事项需要附带提醒（见下方规则）
6. **回答问题**：基于知识条目内容回答用户问题，并附带相关提醒

## 🔍 模糊问题追问规则

当用户提问不够明确时，**必须使用 AskQuestion 工具以选择题形式追问确认**，用户选择后再给出答案。

### 使用方式

调用 `AskQuestion` 工具，提供选项让用户点击选择：

```
AskQuestion({
  title: "请确认具体场景",
  questions: [{
    id: "scenario",
    prompt: "问题描述",
    options: [
      { id: "option1", label: "选项1" },
      { id: "option2", label: "选项2" }
    ]
  }]
})
```

### DLC 相关

**触发问题**："DLC 怎么打"、"如何打 DLC"、"DLC 打包"

```json
{
  "title": "DLC 打包确认",
  "questions": [{
    "id": "dlc_type",
    "prompt": "请问你要打哪种 DLC？",
    "options": [
      { "id": "test", "label": "测试 DLC（用 14/40 打包机）" },
      { "id": "prod", "label": "正式 DLC（用 28 打包机）" }
    ]
  }]
}
```

**触发问题**："DLC 怎么配置"、"entrance 怎么配"

```json
{
  "title": "DLC 配置确认",
  "questions": [{
    "id": "dlc_env",
    "prompt": "请问你要配置哪个环境？",
    "options": [
      { "id": "test", "label": "测试环境（本地 Entrance.json）" },
      { "id": "prod", "label": "线上环境（TGS 后台）" }
    ]
  }]
}
```

### 打包相关

**触发问题**："怎么打包"、"如何出包"、"打包流程"

```json
{
  "title": "打包类型确认",
  "questions": [{
    "id": "package_type",
    "prompt": "请问你要打哪种包？",
    "options": [
      { "id": "world_android", "label": "国际服安卓包（10 打包机）" },
      { "id": "world_ios", "label": "国际服 iOS 包（10 打包机）" },
      { "id": "cn", "label": "国服包（8 打包机）" },
      { "id": "dlc_test", "label": "测试 DLC（14/40 打包机）" },
      { "id": "dlc_prod", "label": "正式 DLC（28 打包机）" }
    ]
  }]
}
```

**触发问题**："安卓包怎么打"、"iOS 包怎么打"

```json
{
  "title": "包类型确认",
  "questions": [{
    "id": "build_type",
    "prompt": "请问是测试包还是正式包？",
    "options": [
      { "id": "test", "label": "测试包（用 temp 工程）" },
      { "id": "prod", "label": "正式包（用 master 工程）" }
    ]
  }]
}
```

### 环境相关

**触发问题**："怎么进审核服"、"审核服怎么测"

```json
{
  "title": "审核服确认",
  "questions": [{
    "id": "review_server",
    "prompt": "请问是哪个审核服？",
    "options": [
      { "id": "world", "label": "国际服审核服（2/3 服）" },
      { "id": "cn", "label": "国服审核服（6001 服）" }
    ]
  }]
}
```

**触发问题**："服务器怎么部署"

```json
{
  "title": "服务器类型确认",
  "questions": [{
    "id": "server_type",
    "prompt": "请问要部署哪种服务器？",
    "options": [
      { "id": "test", "label": "测试服" },
      { "id": "review", "label": "审核服" }
    ]
  }]
}
```

### 支付相关

**触发问题**："怎么测支付"、"支付怎么测"

```json
{
  "title": "支付渠道确认",
  "questions": [{
    "id": "payment_channel",
    "prompt": "请问是哪个渠道的支付？",
    "options": [
      { "id": "gp", "label": "GP（谷歌商店）" },
      { "id": "ios", "label": "iOS（App Store）" },
      { "id": "huawei", "label": "华为" },
      { "id": "cn", "label": "国服（支付宝/微信）" },
      { "id": "other", "label": "其他（Flexion/Catappult/Emulator）" }
    ]
  }]
}
```

### 渠道相关

**触发问题**："渠道包怎么测"、"渠道包测试"

```json
{
  "title": "渠道包测试类型确认",
  "questions": [{
    "id": "channel_test_type",
    "prompt": "请问是哪种渠道包测试？",
    "options": [
      { "id": "new", "label": "新增渠道包（首次测试）" },
      { "id": "existing", "label": "已有渠道包（版本验证）" }
    ]
  }]
}
```

### 通用规则

1. 当问题可能对应 **2 个及以上场景** 时，**必须使用 AskQuestion 工具**
2. 选项要 **简洁明了**，包含关键区分信息
3. 用户选择后，根据选择结果给出 **针对性答案**
4. 如果用户直接说明了具体场景，则无需追问

## ⚠️ 场景触发提醒规则

当用户提问涉及以下场景时，**必须在回答末尾附带相关提醒**：

### 时间相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| 调时间、改时间、nextday、nexthour、tofakeday | ⚠️ **调时间不要超过一年**，否则 BI 日志表记不到数据 |

### 特效相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| 特效、特效问题、特效缺失、特效异常 | ⚠️ **UI 特效问题找张冠斌，模型特效问题找刘松**；先提给策划，确认是特效本身问题再转特效同学 |

### 功能测试相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| 测试功能、功能测试、新功能 | ⚠️ **测试功能一定要开引导**，引导也会影响老功能的优化 |

### 英雄/Buff 相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| 英雄、皮肤、行军特效、buff | ⚠️ **注意和策划核对 buff 类型**，历史案例：应该是打击手的给了射击手 |

### 战装试炼场相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| 战装试炼场、bossrush | ⚠️ **不能用一拳超人**，否则无法进入 |

### Crash/日志相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| crash、闪退、日志、log | ⚠️ **日志路径**：`sdcard/Android/data/com.tap4fun.ape.gplay/files/log`，重进游戏前保存，否则会被清掉 |

### KVK 相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| kvk、movekvk、跨服 | ⚠️ **KVK 前置条件**：账号需有帮派、氏族，且开服满 15 天 |

### DLC 相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| dlc验证、正式dlc、hotfix | ⚠️ **DLC 验证四步**：完整验证一个渠道 → 分支覆盖 → 渠道抽查 → 版本兼容抽查 |

### 支付相关
| 触发关键词 | 必须提醒 |
|------------|----------|
| ios支付、沙盒支付、苹果支付 | ⚠️ **iOS 沙盒支付**：必须先退出 App Store 账号，在游戏内拉起支付后再输入沙盒账号 |
| catappult、appcoins | ⚠️ **Catappult 钱包**：激活后保质期 1 个月，过期找庞浩东重新激活 |
| 华为支付 | ⚠️ **华为沙盒**：需要找 zhangjinge 把账号设置为沙盒账号 |

## 使用方法

### 1. 直接提问
用户可以用自然语言提问，AI 会自动匹配最相关的知识条目：
```
用户：如何给手机安装aab包？
AI：[自动匹配 environment/aab-phone-install.md 并回答]
```

### 2. 关键词搜索
支持关键词快速定位：
- `kadmin` → 服务器管理工具使用
- `jenkins` → 打包机使用
- `entrance` / `tgs` → TGS配置系统
- `dlc` / `hotfix` → DLC热更流程
- `合服` → 合服测试流程
- `新服` → 新服测试流程
- `aab` → aab包安装方法
- `回退` → 环境回退操作

## 知识库结构

```
qa-knowledge/
├── SKILL.md                    # 本文件
├── _index.json                 # 全局语义索引
├── categories/
│   ├── onboarding/             # 新手入门
│   ├── tools/                  # 工具使用
│   ├── environment/            # 环境配置
│   ├── workflows/              # 测试流程
│   └── references/             # 参考资料
└── templates/
    └── entry-template.md       # 知识条目模板
```

## 分类说明

### onboarding/ - 新手入门
新人入职必读，包括权限申请、环境搭建、团队沟通等。

### tools/ - 工具使用
测试常用工具的操作指南：
- Kadmin：服务器管理
- Jenkins：打包机
- TGS/Entrance：配置系统
- Postman：热更操作

### environment/ - 环境配置
测试环境相关：
- aab包安装（PC/手机）
- 客户端问题排查
- 环境回退方法

### workflows/ - 测试流程
标准测试流程SOP：
- 新服测试
- 合服测试
- DLC测试
- 渠道包测试

### references/ - 参考资料
常用参考信息：
- 渠道包列表
- 测试账号信息

## 维护指南

### 新增知识条目
1. 使用 `templates/entry-template.md` 模板
2. 放入对应分类目录
3. 运行索引更新脚本

### 更新现有条目
1. 直接编辑对应 md 文件
2. 更新 `updated` 日期
3. 如有新别名/标签，同步更新

### 索引更新
知识条目变更后，需要更新索引以保证搜索准确性。

---
*最后更新：2026-02-12*
*维护人：李映荷*
